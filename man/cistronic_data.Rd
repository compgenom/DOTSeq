% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/analysis.R
\name{cistronic_data}
\alias{cistronic_data}
\title{Prepare Data and Metadata for DOU Heatmap}
\usage{
cistronic_data(
  results,
  dou_rowdata,
  dou_estimates_col = "PosteriorMean",
  dou_padj_col = "lfsr",
  flip_sign = TRUE,
  sorf_type = "uORF",
  species_dataset = "hsapiens_gene_ensembl",
  symbol_col = "hgnc_symbol",
  threshold = 0.05
)
}
\arguments{
\item{results}{A data frame from \code{testDOT} containing DOU estimates, gene labels, and group IDs.
Must include columns for DOU effect sizes and lfsr values.}

\item{dou_estimates_col}{Character string specifying the column name for DOU effect size estimates.
Default is \code{"PosteriorMean"}.}

\item{dou_padj_col}{Character string specifying the column name for DOU significance values.
Should correspond to local false sign rate (lfsr). Default is \code{"lfsr"}.}

\item{flip_sign}{Logical; if \code{TRUE}, flips the sign of DOU estimates to align directionality
with translation efficiency. Default is \code{TRUE}.}

\item{species_dataset}{Ensembl dataset name, e.g., \code{"hsapiens_gene_ensembl"}.}

\item{symbol_col}{Column name for gene symbols in Ensembl, e.g., \code{"hgnc_symbol"} or \code{"mgi_symbol"}.}

\item{threshold}{Numeric threshold for lfsr-based significance filtering. Default is \code{0.05}.}

\item{orf_type}{Character string specifying the ORF type to compare with mORFs.
Accepts \code{"uORF"} or \code{"dORF"}.}
}
\value{
A list containing:
\describe{
\item{ordered_matrix}{Matrix of DOU estimates for significant ORFs.}
\item{row_dend_clean}{Dendrogram object for row clustering.}
\item{highlight_df}{Data frame indicating significant tiles to highlight.}
\item{genes}{Full gene annotation data retrieved from Ensembl.}
\item{gene_labels}{Vector of gene symbols for heatmap rows.}
\item{color_palette}{Color palette for heatmap visualization.}
\item{color_breaks}{Breaks used for color scaling.}
\item{abs_max}{Maximum absolute value used for color scaling.}
}
}
\description{
Prepares a matrix of differential ORF usage (DOU) estimates for heatmap visualization,
comparing mORFs with either uORFs or dORFs. Filters significant ORFs based on local false sign rate (lfsr),
clusters rows, and retrieves gene annotations from Ensembl for labeling.
}
\details{
This function is designed to support visualization of differential ribosome loading across ORFs
within genes. It uses empirical Bayes shrinkage via the \code{ashr} package to compute lfsr,
and filters ORFs with lfsr below the specified threshold. Gene annotations are retrieved from
Ensembl using the \code{biomaRt} package.
}
\keyword{internal}
