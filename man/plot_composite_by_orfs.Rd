% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/analysis.R
\name{plot_composite_by_orfs}
\alias{plot_composite_by_orfs}
\title{Plot Composite Scatter for DTE vs DOU with Marginal Distributions by ORF Types}
\usage{
plot_composite_by_orfs(
  results,
  rowdata,
  marginal_plot_type = "density",
  dou_estimates_col = "PosteriorMean",
  dou_padj_col = "lfsr",
  dte_estimates_col = "log2FoldChange",
  dte_padj_col = "padj",
  dou_padj_threshold = 0.05,
  dte_padj_threshold = 0.05,
  flip_sign = TRUE,
  lhist = 20
)
}
\arguments{
\item{results}{A data frame containing DTE and DOU post hoc contrast results. Must include columns for DTE and DOU estimates,
adjusted p-values (e.g., \code{padj} for DTE and \code{lfsr} for DOU), and an \code{orf_id} column for merging.}

\item{rowdata}{A data frame containing ORF metadata, with row names corresponding to \code{orf_id}. Must include an \code{orf_type} column
with values "uORF", "mORF", or "dORF".}

\item{marginal_plot_type}{Character string specifying the type of marginal plot: either \code{"histogram"} or \code{"density"}.
Default is \code{"density"}.}

\item{dou_estimates_col}{Column name for DOU posterior estimates. Default is \code{"PosteriorMean"}.}

\item{dou_padj_col}{Column name for DOU significance values (typically local false sign rate). Default is \code{"lfsr"}.}

\item{dte_estimates_col}{Column name for DTE estimates (typically log2 fold-change). Default is \code{"log2FoldChange"}.}

\item{dte_padj_col}{Column name for DTE adjusted p-values. Default is \code{"padj"}.}

\item{dou_padj_threshold}{Numeric threshold for DOU significance. Default is \code{0.05}.}

\item{dte_padj_threshold}{Numeric threshold for DTE significance. Default is \code{0.05}.}

\item{flip_sign}{Logical; if \code{TRUE}, flips the sign of DOU estimates to align directionality with DTE. Default is \code{TRUE}.}

\item{lhist}{Integer; number of bins for marginal histograms. Default is \code{20}.}
}
\value{
A composite plot consisting of:
\describe{
\item{Scatter plot}{Displays DTE (log2 fold-change) vs DOU (log-odds change) estimates, colored by ORF type.}
\item{Marginal plots}{Show the distribution of DTE and DOU estimates along the top and right margins, using either histograms or density curves.}
}
The function also prints the Spearman correlation between DTE and DOU estimates to the console.
}
\description{
Generates a composite plot to visualize the relationship between differential translation efficiency (DTE)
and differential ORF usage (DOU). The central scatter plot shows DTE vs DOU estimates for ORFs, colored by ORF type
(uORF, mORF, dORF), while marginal plots (histograms or density curves) display the distribution of DTE and DOU estimates.
This visualization helps assess the overlap and divergence between DTE and DOU signals across ORF types.
}
\details{
The function uses base R graphics and a custom layout matrix to arrange the scatter and marginal plots.
ORFs are colored by type (uORF, mORF, dORF) using semi-transparent colors for visual clarity.
Significance thresholds are used internally for filtering, but not for coloring in this version.
}
\keyword{internal}
