% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/analysis.R
\name{plot_composite}
\alias{plot_composite}
\title{Plot Composite Scatter and Marginal Histograms for DTE vs DOU}
\usage{
plot_composite(
  results,
  dou_estimates_col = "PosteriorMean",
  dou_padj_col = "lfsr",
  dte_estimates_col = "log2FoldChange",
  dte_padj_col = "padj",
  dou_padj_threshold = 0.05,
  dte_padj_threshold = 0.05,
  flip_sign = FALSE,
  lhist = 20
)
}
\arguments{
\item{results}{A data frame containing results from DTE and DOU post hoc contrasts.
Must include columns for DTE and DOU posterior estimates, and adjusted p-values
(e.g., \code{padj} for DTE and \code{lfsr} for DOU).}

\item{dou_estimates_col}{Character string specifying the column name for DOU estimates.
Default is \code{"PosteriorMean"}.}

\item{dou_padj_col}{Character string specifying the column name for DOU significance values.
Should correspond to local false sign rate (lfsr). Default is \code{"lfsr"}.}

\item{dte_estimates_col}{Character string specifying the column name for DTE estimates.
Default is \code{"log2FoldChange"}.}

\item{dte_padj_col}{Character string specifying the column name for DTE adjusted p-values.
Default is \code{"padj"}.}

\item{dou_padj_threshold}{Numeric threshold for DOU LFSR significance. Default is \code{0.05}.}

\item{dte_padj_threshold}{Numeric threshold for DTE adjusted p-value significance. Default is \code{0.05}.}

\item{flip_sign}{Logical; if \code{TRUE}, flips the sign of the DOU estimates.
Useful for aligning directionality with DTE. Default is \code{TRUE}.}

\item{lhist}{Integer; number of bins to use for the marginal histograms.
Default is \code{20}.}
}
\value{
A composite plot with:
\describe{
\item{Scatter plot}{Displays DTE (log2 fold-change) vs DOU (log-odds change) estimates,
with points colored by significance category: DTE-only, DOU-only, both, or neither.}
\item{Marginal histograms}{Show the distribution of DTE and DOU estimates along the top and right margins.}
}
Additionally, the function prints the Spearman correlation between DTE and DOU estimates to the console.
}
\description{
Visualizes the relationship between differential translation efficiency (DTE)
and differential ORF usage (DOU) using a scatter plot with marginal histograms.
ORFs are colored based on significance in DTE, DOU, or both tests.
This plot helps assess the overlap and divergence between DTE and DOU signals.
}
\details{
The function uses base R graphics and a custom layout to combine scatter and histogram plots.
Significant ORFs are determined using a threshold of 0.05 on adjusted p-values.
}
\keyword{internal}
