% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simulation.R
\name{get_params}
\alias{get_params}
\title{Estimate zero-inflated negative binomial parameters from count data}
\usage{
get_params(
  counts,
  threshold = NULL,
  size_factor = NULL,
  min_size = NULL,
  scale_p0 = NULL
)
}
\arguments{
\item{counts}{A numeric matrix of counts (e.g., transcript or gene-level).}

\item{threshold}{Optional numeric. Only rows with mean counts above this threshold
are used for parameter estimation.}

\item{size_factor}{Optional numeric. A scaling factor applied to the estimated
size parameters.}

\item{min_size}{Optional numeric. Minimum allowed value for size estimates;
values below this are replaced with \code{min_size}.}

\item{scale_p0}{Optional numeric. A scaling factor applied to the estimated
zero-inflation probabilities \code{p0}. Values are capped at 1.}
}
\value{
A list with the following components:
\describe{
\item{p0}{A numeric vector of estimated probabilities that a count is zero.}
\item{mu}{A numeric vector of estimated negative binomial means (non-zero counts).}
\item{size}{A numeric vector of estimated negative binomial size parameters.}
\item{fit}{A \code{smooth.spline} object relating log mean to log size.}
}
}
\description{
This function estimates the parameters of a zero-inflated negative binomial
(ZINB) distribution using the method of moments, based on a real count matrix.
It also returns a spline fit relating log mean to log size, which can be used
for simulating new data.
}
\examples{
\dontrun{
  library(ballgown)
  data(bg)
  countmat <- fpkm_to_counts(bg, mean_rps = 400000)
  params <- get_params(countmat, threshold = 1, size_factor = 1.2, min_size = 0.1)
}

}
\author{
Jeff Leek (original), Chun Shen Lim (modifications)
}
