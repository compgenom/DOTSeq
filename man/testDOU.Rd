% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/posthoc.R
\name{testDOU}
\alias{testDOU}
\title{Compute Differential ORF Usage (DOU) Contrasts Using Estimated Marginal Means}
\usage{
testDOU(
  sumExp,
  emm_specs = ~condition * strategy,
  contrasts_method = "pairwise",
  nullweight = 500,
  BPPARAM = bpparam(),
  verbose = TRUE
)
}
\arguments{
\item{sumExp}{A SummarizedExperiment object containing fitted model objects,
typically stored in \code{rowData(sumExp)[['fitDOUModels']]}.}

\item{emm_specs}{A formula specifying the structure of the estimated marginal means.
Default is \code{~condition * strategy}.}

\item{contrasts_method}{Character string specifying the method for computing contrasts.
Default is \code{"pairwise"}.}

\item{nullweight}{Numeric. Prior weight on the null hypothesis for empirical Bayes shrinkage.
Higher values yield more conservative lfsr estimates. Default is \code{500}.}

\item{verbose}{Logical. If \code{TRUE}, prints progress messages. Default is \code{TRUE}.}

\item{workers}{Integer. Number of parallel workers to use. Default is \code{1}.}
}
\value{
A \strong{SummarizedExperiment} object (the input \code{sumExp} or \code{m$sumExp})
with two new \code{S4Vectors::DataFrame} objects stored in its \code{metadata} slot.
These tables contain the long-format results for all computed contrasts:
\describe{
\item{\code{interaction_results}}{A long-format \code{S4Vectors::DataFrame} containing the
\strong{Differential ORF Usage (DOU) effect sizes} (Ribo-seq contrast minus RNA-seq contrast)
for all computed interaction contrasts. Columns include \code{contrast},
the full set of shrunken and unshrunken metrics (e.g., \code{betahat}, \code{sebetahat},
\code{WaldPadj}, \code{PosteriorMean}, \code{lfsr}).}
\item{\code{strategy_results}}{A long-format \code{S4Vectors::DataFrame} containing the
\strong{strategy-specific effect sizes} (e.g., estimates for Ribo-seq only) for all computed contrasts.
Columns include \code{strategy} (e.g., "ribo", "rna"), \code{contrast},
and the full set of shrunken and unshrunken metrics.}
}
}
\description{
Performs Differential ORF Usage (DOU) analysis by computing contrasts between ribosome profiling
and RNA-seq modalities using estimated marginal means (EMMs) from fitted GLMM models.
Supports both interaction-specific and strategy-specific contrasts, and applies empirical Bayes
shrinkage via the \code{ashr} package to stabilize effect size estimates.
}
\details{
The results for post hoc contrasts are stored in a long format via explicit \code{contrast} and/or
\code{strategy} columns. Non-converged models are omitted.
}
