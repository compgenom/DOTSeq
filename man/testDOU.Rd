% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/testDOT.R
\name{testDOU}
\alias{testDOU}
\title{Test for Differential ORF Usage (DOU) Using Estimated Marginal Means}
\usage{
testDOU(
  m,
  emm_specs = ~condition * strategy,
  contrasts_method = "pairwise",
  workers = 1,
  BPPARAM = BiocParallel::bpparam(),
  verbose = FALSE
)
}
\arguments{
\item{m}{A named list of fitted model objects (e.g., from \code{glmmTMB}), one per ORF.}

\item{emm_specs}{A formula specifying the EMM structure (default: \code{~condition * strategy}).}

\item{contrasts_method}{Character. Method for computing contrasts (default: \code{"pairwise"}).}

\item{workers}{Integer. Number of parallel workers to use (default: \code{1}).}

\item{BPPARAM}{A BiocParallel parameter object for parallel execution (default: \code{BiocParallel::bpparam()}).}

\item{verbose}{Logical. If \code{TRUE}, print progress messages (default: \code{FALSE}).}
}
\value{
A named list with two components:
\describe{
\item{interaction_specific}{A list of contrast-specific data frames containing effect sizes, standard errors, shrunk estimates, local false sign rates (lfsr), and q-values.}
\item{strategy_specific}{A nested list of contrast-strategy combinations with the same structure as above.}
}
}
\description{
Performs differential ORF usage (DOU) analysis using estimated marginal means (EMMs)
from a fitted model object. Computes contrast-specific effect sizes and applies
empirical Bayes shrinkage using the \code{ashr} package. Supports both interaction-specific
and strategy-specific contrasts.
}
\details{
The function first filters out invalid or NULL EMM objects. For each valid contrast,
it computes the difference in effect sizes between ribosome profiling and RNA-seq
(i.e., DOU), estimates the standard error, and applies shrinkage using \code{ashr::ash}.

Strategy-specific contrasts are also computed separately for each modality.
}
