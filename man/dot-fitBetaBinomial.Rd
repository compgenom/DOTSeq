% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/model_fit_utils.R
\name{.fitBetaBinomial}
\alias{.fitBetaBinomial}
\title{Fit Beta-Binomial Models for a Single Gene}
\usage{
.fitBetaBinomial(
  ribo_mat,
  rna_mat,
  anno,
  formula = ~condition * strategy,
  emm_specs = ~condition * strategy,
  target = NULL,
  dispersion_modeling = c("auto", "shared", "custom"),
  dispformula = NULL,
  lrt = FALSE,
  diagnostic = FALSE,
  seed = NULL,
  optimizers = FALSE,
  parallel = list(n = 4L, autopar = TRUE),
  verbose = FALSE
)
}
\arguments{
\item{ribo_mat}{A numeric matrix of Ribo-seq counts for a single gene (rows = ORFs, columns = samples).}

\item{rna_mat}{A numeric matrix of RNA-seq counts for the same gene (same dimensions as \code{ribo_mat}).}

\item{anno}{A data frame containing sample annotations. Must include columns such as \code{condition}, \code{strategy}, and \code{replicate}.}

\item{formula}{A formula object specifying the model design, e.g., \code{~ condition * strategy}.}

\item{target}{Character string specifying the non-reference condition level to extract the corresponding interaction term from the model.
This is contrasted against the baseline condition (default: \code{NULL}).}

\item{dispersion_modeling}{Character string specifying the dispersion modeling strategy.
Options are:
\describe{
\item{\code{"auto"}}{Fit both strategy-dependent and shared dispersion models, and select the best via likelihood ratio test.}
\item{\code{"shared"}}{Assume constant dispersion across all predictor levels.}
\item{\code{"custom"}}{Use a user-specified dispersion formula via \code{dispformula}.}
}}

\item{dispformula}{Optional formula object specifying a custom dispersion model (used when \code{dispersion_modeling = "custom"}).}

\item{lrt}{Logical; if \code{TRUE}, performs a likelihood ratio test to compare the full model (with interaction) against a reduced model
(without interaction) to assess translation-specific effects (default: \code{FALSE}).}

\item{diagnostic}{Logical; if \code{TRUE}, runs DHARMa diagnostics to assess model fit (default: \code{FALSE}).}

\item{seed}{Optional integer to set the random seed for reproducibility (default: \code{NULL}).}

\item{optimizers}{Logical; if \code{TRUE}, enables brute-force optimization using multiple optimizers in \code{glmmTMB} (default: \code{FALSE}).}

\item{parallel}{A list passed to \code{glmmTMBControl} to configure parallel optimization,
e.g., \code{list(parallel = TRUE, ncpus = 4)}. Default: \code{list(n = 4L, autopar = TRUE)}.}

\item{verbose}{Logical; if \code{TRUE}, prints progress messages (default: \code{FALSE}).}
}
\value{
A named \code{list} of \code{PostHoc} objects, one for each ORF in the gene.
}
\description{
This internal worker function fits beta-binomial generalized linear models (GLMs) or generalized linear mixed models (GLMMs)
for all ORFs within a single gene using \code{glmmTMB}. It supports multiple dispersion
modeling strategies and optional model diagnostics.
}
\keyword{internal}
