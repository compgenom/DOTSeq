% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/heatmap.R
\name{pairedData}
\alias{pairedData}
\title{Prepare Data and Metadata for DOU Heatmap}
\usage{
pairedData(
  results,
  dou_estimates_col = "PosteriorMean",
  dou_padj_col = "tests.padj",
  flip_sign = TRUE,
  orf_type = "uORF",
  species_dataset = "hsapiens_gene_ensembl",
  symbol_col = "hgnc_symbol",
  threshold = 0.05
)
}
\arguments{
\item{results}{A data frame from \code{testDOT} containing DOU estimates, gene labels, and group IDs.}

\item{dou_estimates_col}{Character string specifying the column name for DOU estimates.
Default is \code{"PosteriorMean"}.}

\item{dou_padj_col}{Character string specifying the column name for DOU adjusted p-values.
Default is \code{"tests.padj"}.}

\item{flip_sign}{Logical; if \code{TRUE}, flips the sign of DOU estimates (default: \code{TRUE}).}

\item{orf_type}{Character string specifying the ORF type to compare with mORFs. Accepts \code{"uORF"} or \code{"dORF"}.}

\item{species_dataset}{Ensembl dataset name, e.g., \code{"hsapiens_gene_ensembl"}.}

\item{symbol_col}{Column name for gene symbols in Ensembl, e.g., \code{"hgnc_symbol"} or \code{"mgi_symbol"}.}

\item{threshold}{Numeric threshold for significance filtering (default: \code{0.05}).}
}
\value{
A list containing:
\describe{
\item{orderedMatrix}{Matrix of DOU estimates for significant ORFs.}
\item{rowDendClean}{Dendrogram object for row clustering.}
\item{highlight_df}{Data frame indicating significant tiles to highlight.}
\item{genes}{Full gene annotation data from Ensembl.}
\item{gene_labels}{Vector of gene symbols for heatmap rows.}
\item{color_palette}{Color palette for heatmap.}
\item{color_breaks}{Breaks used for color scaling.}
\item{abs_max}{Maximum absolute value for color scaling.}
}
}
\description{
This function prepares a matrix of DOU estimates for heatmap visualization,
comparing mORFs with either uORFs or dORFs. It filters significant ORFs,
clusters rows, and retrieves gene annotations from Ensembl.
}
