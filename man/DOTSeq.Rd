% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/DOTSeq.R
\name{DOTSeq}
\alias{DOTSeq}
\title{Perform Differential ORF Translation Analysis with DOTSeq}
\usage{
DOTSeq(
  dot = NULL,
  count_table = NULL,
  condition_table = NULL,
  flattened_gtf = NULL,
  bed = NULL,
  formula = ~condition * strategy,
  modules = c("DOU", "DTE"),
  target = NULL,
  baseline = NULL,
  min_count = 1,
  stringent = TRUE,
  dispersion_modeling = "auto",
  dispformula = NULL,
  lrt = FALSE,
  diagnostic = FALSE,
  parallel = list(n = 4L, autopar = TRUE),
  optimizers = FALSE,
  nullweight = 500,
  contrasts_method = "revpairwise",
  verbose = TRUE
)
}
\arguments{
\item{dot}{A \code{\link{DOTSeqResults}} object pre-constructed using
\code{\link{DOTSeqDataSet}}. This list must include:
\describe{
\item{\code{DOU}}{
A \code{DOTSeqDataSet} object containing filtered
raw counts, sample metadata, and ORF-level annotations.
}
\item{\code{DTE}}{
A \code{DESeqDataSet} object used for modeling DTE via DESeq2.
}
}
If \code{dot} is provided, the function skips raw input
parsing and uses these objects directly.}

\item{count_table}{Path to a count table file or a data frame. Must contain
columns: \code{Geneid}, \code{Chr}, \code{Start}, \code{End},
\code{Strand}, \code{Length}, plus one column per sample.}

\item{condition_table}{Path to a sample metadata file or a data frame.
Must include columns: \code{run}, \code{strategy}, \code{condition},
\code{replicate}.}

\item{flattened_gtf}{Optional path to a flattened GFF/GTF file.}

\item{bed}{Path to a BED file with ORF annotations.}

\item{formula}{A formula object specifying the design.
Default is \code{~ condition * strategy}.}

\item{modules}{Character vector specifying which DOTSeq modules to run.
Options include \code{"DOU"} and \code{"DTE"}.
Default is \code{c("DOU", "DTE")}.}

\item{target}{Character string specifying the non-reference condition level
to extract the corresponding interaction term.
Default is \code{NULL}.}

\item{baseline}{Character string specifying the desired reference level.
Default is \code{NULL}.}

\item{min_count}{Minimum count threshold for filtering ORFs.
Default is \code{1}.}

\item{stringent}{Logical or \code{NULL}; determines the filtering strategy:
\describe{
\item{\code{TRUE}}{
Keep ORFs where all replicates in at least one condition pass
\code{min_count}.
}
\item{\code{FALSE}}{
Keep ORFs where all replicates in at least one condition-strategy
group pass \code{min_count}.
}
\item{\code{NULL}}{
Keep ORFs where total counts across replicates pass
\code{min_count}.
}
}}

\item{dispersion_modeling}{String specifying the dispersion modeling
approach for DOU. Options include \code{"auto"}, \code{"shared"},
or \code{"custom"}. Default is \code{"auto"}.}

\item{dispformula}{Optional formula object for custom dispersion modeling.}

\item{lrt}{Logical; if \code{TRUE}, performs a likelihood ratio test
comparing full vs reduced models in DOU.
Default is \code{FALSE}.}

\item{diagnostic}{Logical; if \code{TRUE}, enables model diagnostics in DOU.
Default is \code{FALSE}.}

\item{parallel}{A list passed to \code{\link[glmmTMB]{glmmTMBControl}} to configure parallel
optimization in DOU. Default is \code{list(n = 4L, autopar = TRUE)}.}

\item{optimizers}{Logical; if \code{TRUE}, enables brute-force optimization
using multiple optimizers in \code{\link[glmmTMB]{glmmTMBControl}}.
Default is \code{FALSE}.}

\item{nullweight}{Numeric. Prior weight on the null hypothesis for empirical
Bayes shrinkage in DOU. Default is \code{500}.}

\item{contrasts_method}{Character string specifying the method for post hoc
contrasts in DOU. Default is \code{"revpairwise"}.}

\item{verbose}{Logical; if \code{TRUE}, prints progress messages.
Default is \code{TRUE}.}
}
\value{
A named \code{list} containing:
\describe{
\item{\code{DOU}}{
A \code{DOTSeqDataSet} object with DOU results.
}
\item{\code{DTE}}{
A \code{DESeqDataSet} object with DTE results.
}
}
}
\description{
DOTSeq is a statistical framework for modeling Differential ORF
Translation using ribosome profiling (Ribo-seq) and RNA-seq data. It
includes a novel beta-binomial modeling approach for detecting
Differential ORF Usage (DOU), and integrates DESeq2-based modeling for
Differential Translation Efficiency (DTE). This wrapper function
optionally executes one or both modules, including data loading,
ORF-level filtering, model fitting, post hoc contrasts, and adaptive
shrinkage of effect sizes. Plotting and downstream analysis are handled
separately via the \code{\link{plotDOT}} function.
}
\examples{
# Load SummarizedExperiment
library(SummarizedExperiment)

dir <- system.file("extdata", package = "DOTSeq")

cnt <- read.table(
    file.path(dir, "featureCounts.cell_cycle_subset.txt.gz"),
    header = TRUE,
    comment.char = "#"
)
names(cnt) <- gsub(".*(SRR[0-9]+).*", "\\\\1", names(cnt))

flat <- file.path(dir, "gencode.v47.orf_flattened_subset.gtf.gz")
bed <- file.path(dir, "gencode.v47.orf_flattened_subset.bed.gz")

meta <- read.table(file.path(dir, "metadata.txt.gz"))
names(meta) <- c("run", "strategy", "replicate", "treatment", "condition")
cond <- meta[meta$treatment == "chx", ]
cond$treatment <- NULL

dot <- DOTSeq(
    count_table = cnt,
    condition_table = cond,
    flattened_gtf = flat,
    bed = bed,
    modules = "DTE"
)

show(dot)

dou <- getDOU(dot)

set.seed(42)
random_rows <- sample(seq_len(nrow(dou)), size = 50)
getDOU(dot) <- dou[random_rows, ]

dot <- DOTSeq(dot = dot)

dot <- DOTSeqDataSet(
    count_table = cnt,
    condition_table = cond,
    flattened_gtf = flat,
    bed = bed
)

dot <- DOTSeq(dot = dot, modules = "DTE")

}
\references{
Brooks, M. E., Kristensen, K., van Benthem, K. J., Magnusson, A., Berg, C. W.,
Nielsen, A., Skaug, H. J., Mächler, M. and Bolker, B. M. (2017).
glmmTMB balances speed and flexibility among packages for zero-inflated
generalized linear mixed modeling. The R Journal, 378–400.
\doi{10.32614/RJ-2017-066}

Love, M. I., Huber, W., Anders, S. (2014).
Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2.
Genome Biology, 15:550. \doi{10.1186/s13059-014-0550-8}

Lenth, R., Piaskowski, J. (2025).
emmeans: Estimated Marginal Means, aka Least-Squares Means.
R package version 2.0.0. \url{https://rvlenth.github.io/emmeans/}

Stephens, M. (2016).
False discovery rates: a new deal. Biostatistics, 18(2).
\doi{10.1093/biostatistics/kxw041}

Hartig, F. (2025).
DHARMa: Residual Diagnostics for Hierarchical (Multi-Level / Mixed)
Regression Models. R package version 0.4.7.
\url{https://github.com/florianhartig/dharma}
}
\seealso{
\code{\link{DOTSeqDataSet}}, \code{\link{fitDOU}},
\code{\link{testDOU}}, \code{\link{plotDOT}}
}
