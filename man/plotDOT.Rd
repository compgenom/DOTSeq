% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plotting.R
\name{plotDOT}
\alias{plotDOT}
\title{Generate Differential ORF Translation (DOT) Visualization Suite}
\usage{
plotDOT(
  plot_type = "volcano",
  color_by = "significance",
  results = NULL,
  dou = NULL,
  rowdata = NULL,
  id_mapping = NULL,
  include_go = FALSE,
  gene_id = NULL,
  dou_estimates_col = "PosteriorMean",
  dou_estimates_threshold = 1,
  dou_padj_col = "lfsr",
  dou_padj_threshold = 0.05,
  dou_padj_ceiling = 10,
  extreme_threshold = NULL,
  dte_estimates_col = "log2FoldChange",
  dte_padj_col = "padj",
  dte_padj_threshold = 0.05,
  label_topn = 3,
  top_genes = 20,
  ranking_method = "significance",
  sorf_type = "uORF",
  dataset = "hsapiens_gene_ensembl",
  symbol_col = "hgnc_symbol",
  mart_source = "ensembl",
  colors = list(dte = adjustcolor("#0072B2", alpha.f = 0.6), dou = adjustcolor("#E69F00",
    alpha.f = 0.6), both = adjustcolor("#CC79A7", alpha.f = 0.6), none =
    adjustcolor("grey80", alpha.f = 0.6), uorf = adjustcolor("#D73027", alpha.f = 0.6),
    morf = adjustcolor("#4575B4", alpha.f = 0.6), dorf = adjustcolor("#A6A6A6", alpha.f =
    0.6), low = "blue", middle = "white", high = "red", usage = "Set2"),
  legend_position = "topright",
  condition_order = NULL,
  flip_sign = FALSE,
  force_new_device = TRUE,
  verbose = TRUE
)
}
\arguments{
\item{plot_type}{A single string specifying the type of plot to generate.
Options include \code{"venn"}, \code{"composite"}, \code{"volcano"},
\code{"heatmap"}, and \code{"usage"}. Default is \code{"volcano"}.}

\item{color_by}{Character string specifying how to color
points:
\itemize{
\item{\code{"significance"}: Colors by DTE-only,
DOU-only, both significant}
\item{\code{"orf_type"}: Colors by ORF type (requires
\code{rowdata})}
}
Default is \code{"significance"}.}

\item{results}{Required for plotting \code{"venn"}, \code{"composite"},
\code{"volcano"}, and \code{"heatmap"}. A data frame containing
DOU and DTE estimates and significance values. Must include
ORF-level identifiers and columns specified by
\code{dou_estimates_col}, \code{dou_padj_col},
\code{dte_estimates_col}, and \code{dte_padj_col}. Default is
\code{NULL}.}

\item{dou}{Required for plotting \code{"usage"}. A
\code{\link{DOTSeqDataSet}} object containing \code{emmGrid} objects
stored in \code{rowData(dou)[['DOUResults']]}. It should
also contain post hoc results stored in the
\code{\link{interactionResults}} slot. Default is \code{NULL}.}

\item{rowdata}{Optional data frame containing ORF information,
with row names corresponding to \code{orf_id}. Typically
extracted from a \code{SummarizedExperiment} object. Must include
an \code{orf_type} column with values "uORF", "mORF", or "dORF"
if \code{color_by = "orf_type"}. Default is \code{NULL}.}

\item{id_mapping}{Optional data frame containing gene symbols for
the input Ensembl IDs. Can be generated by providing
\code{dou} or \code{rowdata} as input when plotting
\code{"volcano"} or \code{"heatmap"}. Once generated, it can be
reused for plotting \code{"volcano"}, \code{"heatmap"}, and
\code{"usage"} to avoid repeated downloads. Default is \code{NULL}.}

\item{include_go}{Logical; if \code{TRUE}, includes GO annotations
(\code{go_id}, \code{name_1006}, \code{namespace_1003}) in the
\code{id_mapping} output. Default is \code{FALSE}.}

\item{gene_id}{Required for plotting \code{"usage"}. Character string
specifying the gene ID of interest. Default is \code{NULL}.}

\item{dou_estimates_col}{Character string specifying the column name
for DOU effect size estimates. Default is \code{"PosteriorMean"}.}

\item{dou_estimates_threshold}{Numeric threshold for DOU effect size
significance in volcano plot. Default is \code{1}.}

\item{dou_padj_col}{Character string specifying the column name for
DOU significance values (LFSR). Default is \code{"lfsr"}.}

\item{dou_padj_threshold}{Numeric threshold for DOU LFSR significance.
Default is \code{0.05}.}

\item{dou_padj_ceiling}{Numeric value to define the rounding ceiling
for -log10(LFSR). The maximum y-axis value will be rounded up to
the nearest multiple of this value. Default is \code{10}.}

\item{extreme_threshold}{Optional numeric threshold for labeling
extreme points in the volcano plot (based on -log10 LFSR).}

\item{dte_estimates_col}{Character string specifying the column name
for DTE effect size estimates. Default is \code{"log2FoldChange"}.}

\item{dte_padj_col}{Character string specifying the column name for
DTE adjusted p-values. Default is \code{"padj"}.}

\item{dte_padj_threshold}{Numeric threshold for DTE adjusted
p-value significance. Default is \code{0.05}.}

\item{label_topn}{Optional numeric. If specified, labels the top N
most significant points in the volcano plot.}

\item{top_genes}{Optional numeric. If specified, limits the heatmap
to the top N genes ranked by DOU magnitude and significance.}

\item{ranking_method}{Character string specifying how genes should be
ranked for visualization on the heatmap. Options are:
\itemize{
\item \code{"score"}: ranks genes by a composite score defined as
\verb{abs(effect size) × (1 - lfsr)}, which prioritizes genes with large
and confident differential ORF usage.
\item \code{"significance"}: ranks genes by the median lfsr across ORFs, prioritizing
statistical confidence regardless of effect size.
Default is \code{"significance"}.
}}

\item{sorf_type}{Character string specifying the short ORF type to
compare with mORFs. Accepts \code{"uORF"} or \code{"dORF"}.}

\item{dataset}{Character string specifying the Ensembl dataset name
(e.g., \code{"hsapiens_gene_ensembl"}).}

\item{symbol_col}{Character string specifying the column name for gene
symbols in the annotation data. Default is \code{"hgnc_symbol"}.}

\item{mart_source}{Character string specifying the BioMart source.
One of \code{"ensembl"}, \code{"plants"}, \code{"fungi"},
\code{"protists"}, \code{"metazoa"}, or \code{"bacteria"}.}

\item{colors}{A named list of colors used across plots:
\itemize{
\item{\code{dte}, \code{dou}, \code{both}, \code{none}:
for significance-based coloring}
\item{\code{uorf}, \code{morf}, \code{dorf}: for ORF
type-based coloring}
\item{\code{low}, \code{middle}, \code{high}: for
heatmap gradient}
\item{\code{usage}: for condition-specific coloring}
}}

\item{legend_position}{Character string specifying the
position of the legend in the volcano and composite scatter plots.
Options include: \code{"bottomright"}, \code{"bottom"},
\code{"bottomleft"}, \code{"left"}, \code{"topleft"},
\code{"top"}, \code{"topright"}, \code{"right"}, \code{"center"}.
Default is \code{"topright"}.}

\item{condition_order}{Optional character vector specifying the order of
conditions on the \code{"usage"} plot x-axis.}

\item{flip_sign}{Logical; if \code{TRUE}, flips the sign of DOU
estimates to align directionality with DTE. Default is \code{TRUE}.}

\item{force_new_device}{Logical; if \code{TRUE}, detects graphics
error and resets graphics state unconditionally.
Default is \code{TRUE}.}

\item{verbose}{Logical; if \code{TRUE}, prints progress messages.
Default is \code{TRUE}.}
}
\value{
A data frame containing gene symbols retrieved from Ensembl,
used for labeling and heatmap visualization.
}
\description{
Generates a comprehensive suite of visualizations to explore
Differential ORF Usage (DOU) and Translation Efficiency (DTE) results
This includes Venn diagrams, volcano plots, composite scatter plots
with marginal distributions, and heatmaps. It integrates Ensembl gene
symbols and highlights significant ORFs based on empirical Bayes
shrinkage (via the \code{\link[ashr]{ash}} package). It is designed
to provide an overview of translation-specific changes across conditions.
}
\details{
This function orchestrates multiple visualization components to
explore differential translation across ORFs. It uses
\code{\link{testDOU}} output to identify significant ORFs,
retrieves gene symbols via  \code{\link[biomaRt]{getBM}}, and generates
plots to summarize DOU and DTE relationships. The composite scatter
plot includes marginal distributions by ORF type, helping to
visualize the overlap and divergence between DTE and DOU signals.
The volcano plot highlights extreme and top-ranked ORFs, while
the heatmap summarizes DOU across top genes.
}
\examples{
# Example ORF-level results
results_df <- data.frame(
  orf_id = c(
    "ENSG00000139618.19:O001",
    "ENSG00000139618.19:O002",
    "ENSG00000157764.15:O003"
  ),
  lfsr = c(0.01, 0.2, 0.03),
  padj = c(0.02, 0.01, 0.1)
)

rowdata_df <- data.frame(
  orf_id = c(
    "ENSG00000139618.19:O001",
    "ENSG00000139618.19:O002",
    "ENSG00000157764.15:O003"
  ),
  gene_id = c(
    "ENSG00000139618.19",
    "ENSG00000139618.19",
    "ENSG00000157764.15"
  ),
  orf_type = c("mORF", "dORF", "mORF")
)

plotDOT(plot_type = "venn", results = results_df, rowdata = rowdata_df)

}
\references{
Durinck S, Spellman P, Birney E, Huber W (2009). Mapping identifiers
for the integration of genomic datasets with the R/Bioconductor
package biomaRt. Nature Protocols, 4, 1184–1191.
\doi{10.1038/nprot.2009.97}

Durinck S, Moreau Y, Kasprzyk A, Davis S, De Moor B, Brazma A,
Huber W (2005). BioMart and Bioconductor: a powerful link between
biological databases and microarray data analysis. Bioinformatics,
21, 3439–3440. \doi{10.1093/bioinformatics/bti525}

Larsson J, Gustafsson P (2018). “A Case Study in Fitting
Area-Proportional Euler Diagrams with Ellipses Using eulerr.”
In Proceedings of International Workshop on Set Visualization
and Reasoning, volume 2116, 84–91.
\url{https://ceur-ws.org/Vol-2116/paper7.pdf}
}
\seealso{
\code{\link{DOTSeq}}
}
