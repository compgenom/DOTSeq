% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fitDOU.R
\name{.fitDOU_internal}
\alias{.fitDOU_internal}
\title{Fit Differential ORF Usage Models}
\usage{
.fitDOU_internal(
  countData,
  orf2gene,
  anno,
  formula,
  dispformula,
  dispersionStrategy,
  diagnostic,
  parallel,
  optimizers,
  seed,
  verbose
)
}
\arguments{
\item{countData}{A numeric matrix of ORF-level counts (rows = ORFs, columns = samples).}

\item{orf2gene}{A data frame mapping ORF IDs to gene IDs. Must contain columns \code{orf_id} and \code{gene_id}.}

\item{anno}{A data frame containing sample annotations. Must include columns such as \code{condition}, \code{strategy}, and \code{replicate}.}

\item{formula}{A formula object specifying the model design, e.g., \code{~ condition * strategy}.}

\item{dispformula}{Optional formula object specifying a custom dispersion model (used when \code{dispersionStrategy = "custom"}).}

\item{dispersionStrategy}{Character string specifying the dispersion modeling strategy.
Options are:
\describe{
\item{\code{"auto"}}{Fit both strategy-dependent and shared dispersion models, and select the best via likelihood ratio test.}
\item{\code{"strategy"}}{Model dispersion as a function of sequencing strategy.}
\item{\code{"shared"}}{Assume constant dispersion across all predictor levels.}
\item{\code{"custom"}}{Use a user-specified dispersion formula via \code{dispformula}.}
}}

\item{diagnostic}{Logical; if \code{TRUE}, runs DHARMa diagnostics to assess model fit (default: \code{FALSE}).}

\item{parallel}{Logical; if \code{TRUE}, enables parallel processing using \code{BiocParallel} (default: \code{FALSE}).}

\item{optimizers}{Logical; if \code{TRUE}, enables brute-force optimization using multiple optimizers in \code{glmmTMB} (default: \code{FALSE}).}

\item{seed}{Optional integer to set the random seed for reproducibility (default: \code{NULL}).}

\item{verbose}{Logical; if \code{TRUE}, prints progress messages (default: \code{FALSE}).}

\item{BPPARAM}{An object specifying the parallel back-end, e.g., \code{MulticoreParam()} or \code{SnowParam()}.}
}
\value{
A named \code{list} of \code{StatModel} objects, one per ORF.
}
\description{
This internal function fits beta-binomial models for differential ORF usage (DOU)
across all genes. It supports multiple dispersion modeling strategies and optional
diagnostics using DHARMa. This function is adapted from the \code{satuRn} package
to support beta-binomial GLM/GLMMs via \code{glmmTMB}.
}
