% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/contrastDOT.R
\name{contrastDOU}
\alias{contrastDOU}
\title{Compute Differential ORF Usage (DOU) Contrasts Using Estimated Marginal Means}
\usage{
contrastDOU(
  m,
  emm_specs = ~condition * strategy,
  contrasts_method = "pairwise",
  workers = 1,
  nullweight = 500,
  BPPARAM = BiocParallel::bpparam(),
  verbose = TRUE
)
}
\arguments{
\item{m}{A named list or SummarizedExperiment-like object containing fitted model objects,
typically stored in \code{rowData(m$sumExp)[['fitDOUModels']]}.}

\item{emm_specs}{A formula specifying the structure of the estimated marginal means.
Default is \code{~condition * strategy}.}

\item{contrasts_method}{Character string specifying the method for computing contrasts.
Default is \code{"pairwise"}.}

\item{workers}{Integer. Number of parallel workers to use. Default is \code{1}.}

\item{nullweight}{Numeric. Prior weight on the null hypothesis for empirical Bayes shrinkage.
Higher values yield more conservative lfsr estimates. Default is \code{500}.}

\item{BPPARAM}{A BiocParallel parameter object for parallel execution.
Default is \code{BiocParallel::bpparam()}.}

\item{verbose}{Logical. If \code{TRUE}, prints progress messages. Default is \code{TRUE}.}
}
\value{
A named list with two components:
\describe{
\item{interaction_specific}{A named list of contrast-specific data frames. Each data frame contains:
\code{betahat} (DOU effect size), \code{sebetahat} (standard error), \code{WaldP} (Wald test p-value),
\code{WaldPadj} (Benjamini-Hochberg adjusted p-value), \code{PosteriorMean} (shrunken effect size),
\code{lfsr} (local false sign rate), \code{lfdr} (local false discovery rate), and \code{qvalue}.}
\item{strategy_specific}{A nested list where each top-level element is a contrast name, and each sub-element
is a strategy (e.g., "0" for RNA-seq, "1" for Ribo-seq). Each contains a data frame with the same structure
as above, but without DOU subtraction.}
}
}
\description{
Performs Differential ORF Usage (DOU) analysis by computing contrasts between ribosome profiling
and RNA-seq modalities using estimated marginal means (EMMs) from fitted GLMM models.
Supports both interaction-specific and strategy-specific contrasts, and applies empirical Bayes
shrinkage via the \code{ashr} package to stabilize effect size estimates.
}
\details{
The function extracts valid EMM objects from fitted GLMMs. For each contrast, it computes the
difference in effect sizes between ribosome profiling and RNA-seq (DOU), estimates the standard error,
and applies shrinkage using \code{ashr::ash}. Strategy-specific contrasts are computed separately
for each modality. This function is designed to support benchmarking and downstream statistical
analysis of differential translation at the ORF level.
}
