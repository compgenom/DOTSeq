% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simulation.R
\name{simDOT}
\alias{simDOT}
\title{Simulate Differential ORF Translation (DOT)}
\usage{
simDOT(
  ribo,
  rna,
  regulation_type = NULL,
  orfs = NULL,
  te_genes = 10,
  bgenes = 10,
  num_samples = 2,
  conditions = 2,
  gcoeff = 1.5,
  bcoeff = 0.9,
  num_batches = 2,
  modify_dispersion = FALSE,
  size_factor = 1.5,
  min_size = 5,
  scale_p0 = 1,
  shape = 0.6,
  scale = 0.5,
  batch_scenario = "balanced",
  diagplot_ribo = FALSE,
  diagplot_rna = FALSE,
  seed = NULL
)
}
\arguments{
\item{ribo}{A matrix or data frame of ribosome profiling counts (genes x samples).}

\item{rna}{A matrix or data frame of RNA-seq counts (genes x samples).}

\item{regulation_type}{Character. Specifies the type of DOT effect to simulate.
Passed to the \code{scenario} argument of \code{generate_coefficients}.}

\item{orfs}{A data frame of ORF annotations. Must include \code{groupID} and \code{labels} columns.}

\item{te_genes}{Numeric. Percentage of genes to be assigned as differentially translated (default: 10).}

\item{bgenes}{Numeric. Percentage of genes to carry a batch effect (default: 10).}

\item{num_samples}{Integer. Number of biological replicates per condition (default: 2).}

\item{conditions}{Integer. Number of experimental conditions (default: 2).}

\item{gcoeff}{Numeric. Magnitude of log-fold change for DOT effects (default: 1.5).}

\item{bcoeff}{Numeric. Magnitude of batch effect coefficient (default: 0.9).}

\item{num_batches}{Integer. Number of batches (default: 2).}

\item{size_factor}{Numeric scalar. A \strong{multiplicative factor} applied to the
estimated size parameter ($r$) for \emph{all} transcripts.
Since dispersion ($\phi$) is $1/r$, a value \strong{greater than 1}
(e.g., 1.5) will \strong{decrease} the biological dispersion (noise),
making the simulated data less variable. A value less than 1
will increase dispersion (default: 1.5).}

\item{min_size}{Numeric scalar. A \strong{lower bound} for the modified size parameter ($r$).
Any transcript whose modified $r$ falls below this value will be
set to \code{min_size}. This is used to \strong{cap the maximum dispersion}
(noise) in the simulation, preventing transcripts with extremely
low estimated $r$ values from introducing unrealistic or
excessive biological variability (default: 5).}

\item{shape}{Numeric. Shape parameter for gamma distribution used to simulate baseline coefficients (default: 0.6).}

\item{scale}{Numeric. Scale parameter for gamma distribution used to simulate baseline coefficients (default: 0.5).}

\item{batch_scenario}{Character. Specifies the batch effect design. Must be one of:
\itemize{
\item \code{"balanced"}
\item \code{"confounded"}
\item \code{"random"}
\item \code{"unbalanced"}
\item \code{"nested"}
\item \code{"modality_specific"}
}}

\item{diagplot_ribo}{Logical. If \code{TRUE}, generate diagnostic plots for ribo data (default: \code{FALSE}).}

\item{diagplot_rna}{Logical. If \code{TRUE}, generate diagnostic plots for RNA data (default: \code{FALSE}).}

\item{seed}{Optional integer. Sets the random seed for reproducibility (default: \code{NULL}).}

\item{modify_size_factor}{Enable (default: \code{FALSE})}
}
\value{
A list with the following components:
\describe{
\item{simData}{Combined simulated count matrix (genes x samples).}
\item{colData}{Data frame containing sample-level metadata (condition, replicate, strategy, batch).}
\item{labels}{Named binary vector indicating true positive (1) and negative (0) ORFs for DOT.}
\item{logFC}{Named vector of true log-fold changes for the simulated DOT effect.}
}
}
\description{
Simulates ribosome profiling and matched RNA-seq count matrices with specified
differential ORF translation (DOT) effects. The simulation can include batch effects
and supports multiple experimental conditions and replicates.
}
